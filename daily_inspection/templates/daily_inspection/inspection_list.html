{% extends 'base.html' %}

{% block title %}Inspection List{% endblock %}

{% block heading_h1 %}Daily Inspections{% endblock %}
{% block heading_h2 %}View all inspection records{% endblock %}

{% block extra_css %}
<style>
    .table tbody tr {
        cursor: pointer;
        transition: all 0.2s ease-in-out;
    }
    
    .table tbody tr:hover {
        background-color: #f0f0f0 !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .progress {
        height: 10px;
        width: 150px;
        margin-top: 5px;
        background-color: #e9ecef;
        border-radius: 5px;
    }

    .progress-stats {
        font-size: 0.85rem;
        color: #6c757d;
    }

    .inspection-progress {
        min-width: 200px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <div class="card shadow">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead class="table-light">
                            <tr>
                                <th><i class="bi bi-calendar-date"></i> Date</th>
                                <th><i class="bi bi-person-workspace"></i> Shift</th>
                                <th><i class="bi bi-graph-up"></i> Progress</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for inspection in inspections %}
                            <tr onclick="window.location='{% url 'inspection_detail' inspection.inspection_ident %}'">
                                <td>{{ inspection.initiated_at|date:"d M Y" }}</td>
                                <td>
                                    {% if inspection.shift == 'DAY' %}
                                        <span class="badge bg-warning text-dark">
                                            <i class="bi bi-sun-fill"></i> Day
                                        </span>
                                    {% else %}
                                        <span class="badge bg-dark">
                                            <i class="bi bi-moon-fill"></i> Night
                                        </span>
                                    {% endif %}
                                </td>
                                <td class="inspection-progress">
                                    <div class="d-flex align-items-center">
                                        <div class="flex-grow-1">
                                            <div class="progress-stats mb-1">
                                                {{ inspection.inspected_count }} / {{ inspection.total_count }} Assets
                                                <span class="float-end">{{ inspection.progress_percentage|floatformat:1 }}%</span>
                                            </div>
                                            <div class="progress">
                                                <div class="progress-bar {% if inspection.progress_percentage == 100 %}bg-success{% elif inspection.progress_percentage > 50 %}bg-info{% else %}bg-warning{% endif %}" 
                                                     role="progressbar" 
                                                     style="width: {{ inspection.progress_percentage }}%"
                                                     aria-valuenow="{{ inspection.progress_percentage }}" 
                                                     aria-valuemin="0" 
                                                     aria-valuemax="100">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="3" class="text-center py-4">
                                    <i class="bi bi-inbox text-muted" style="font-size: 2rem;"></i>
                                    <p class="text-muted mt-2">No inspections found</p>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}