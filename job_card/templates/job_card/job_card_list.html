{% extends 'base.html' %}
{% block content %}
<h2>Job Cards</h2>
<a href="{% url 'job_card_create' %}">Create New Job Card</a>
<table>
    <thead>
        <tr>
            <th>Job Card Number</th>
            <th>Task Description</th>
            <th>Status</th>
            <th>Maintenance Type</th>
            <th>JC</th>
        </tr>
    </thead>
    <tbody>
        {% for job_card in job_cards %}
        <tr>
            <td>{{ job_card.job_card_number }}</td>
            <td>{{ job_card.task_description }}</td>
            <td>{{ job_card.status }}</td>
            <td>{{ job_card.maintenance_type }}</td>
            <td>
                {% if job_card.maintenance_type == "Preventive" and job_card.preventive_maintenance_id == None %}
                    <a href="/preventive_maintenance/create/?jc={{ job_card.pk }}">Add Preventive Maintenance</a>
                {%  endif %}
                {% if job_card.maintenance_type == "Corrective" and job_card.corrective_maintenance_id == None %}
                    <a href="/corrective_maintenance/create/?jc={{ job_card.pk }}">Add Corrective Maintenance</a>
                {%  endif %}
            </td>
            <td>
                <a href="{% url 'job_card_update' job_card.pk %}">Edit</a>
                <a href="{% url 'job_card_delete' job_card.pk %}">Delete</a>
            </td>
            <td>
                {% if job_card.preventive_maintenance_id %}
                    <a href="/preventive_maintenance/{{ job_card.preventive_maintenance_id }}/update/">PM</a>
                {% endif %}
                {% if job_card.corrective_maintenance_id %}
                    <a href="/corrective_maintenance/update/{{ job_card.corrective_maintenance_id }}/">CM</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
